<!DOCTYPE html><html lang="en"><head><meta charset="utf-8"><link href="/favicon.ico" rel="icon"><meta content="width=device-width,initial-scale=1" name="viewport"><meta content="#000000" name="theme-color"><meta content="Web site created using create-react-app" name="description"><link href="https://fonts.googleapis.com/css2?family=Lato:wght@400;700&display=swap" rel="stylesheet"><link href="/logo192.png" rel="apple-touch-icon"><link href="/manifest.json" rel="manifest"><script type="text/javascript">!function(i){if(i.search){var a={};i.search.slice(1).split("&").forEach((function(i){var l=i.split("=");a[l[0]]=l.slice(1).join("=").replace(/~and~/g,"&")})),void 0!==a.p&&window.history.replaceState(null,null,i.pathname.slice(0,-1)+(a.p||"")+(a.q?"?"+a.q:"")+i.hash)}}(window.location)</script><style>@font-face{font-family:'Cascadia Code PL';src:url(/CascadiaCodePL.woff2)}</style><title>Nathan Smith</title><link href="/static/css/2.ca3edc6c.chunk.css" rel="stylesheet"><link href="/static/css/main.5b3c8666.chunk.css" rel="stylesheet"><link href="https://fonts.googleapis.com" rel="preconnect"><style data-emotion="css-global">html{box-sizing:border-box;color:#333;font-family:Lato,sans-serif;font-size:16px}h1{font-size:2em;font-weight:300}h2{font-size:1.5em;font-weight:300}h3{font-size:1.3em;font-weight:400}h4{font-size:1.15em;font-weight:400}p{font-size:1em;font-weight:400}h1,h2,h3,h4,p{margin:0}h1 .muted,h2 .muted,h3 .muted,h4 .muted,p .muted{color:#707070}*,::after,::before{box-sizing:inherit}</style><style data-emotion="css-global">body{background-color:#e7ecef}</style><style data-emotion="css">.css-m94chg{background-color:#377771;color:#fff;padding:16px}.css-m94chg ul{display:flex;list-style:none;margin:0;padding:0}.css-m94chg ul li{display:block;margin:0 12px;cursor:pointer}.css-m94chg ul li:first-child{margin-left:0}.css-m94chg ul li:last-child{margin-right:0}.css-m94chg ul li.spacer{cursor:initial;-webkit-box-flex:1;flex-grow:1}.css-m94chg ul li a{text-decoration:none}.css-m94chg ul li a,.css-m94chg ul li a:active,.css-m94chg ul li a:hover,.css-m94chg ul li a:visited{color:#fff}.css-m94chg ul li a:hover{text-decoration:underline}</style><link href="https://fonts.gstatic.com" rel="preconnect"><link href="https://api.buttercms.com" rel="preconnect"></head><body><noscript>You need to enable JavaScript to run this app.</noscript><div id="root"><div><header class="css-m94chg"><ul><li><a href="/"><h2 class="">Nathan Smith</h2></a></li><li class="spacer"></li><li><a href="/about"><h2 class="">About</h2></a></li><li><a href="/contact"><h2 class="">Contact</h2></a></li></ul></header><div><h1>Publishing a Dev and Production CRA App to GH Pages</h1><h4>May 20, 2020, 12:57 PM</h4><div class="line-numbers"><p>GitHub Pages is a free static site hosting service from GitHub that allows you to freely publish a static site with a custom domain. What if you want to publish two different versions of your create-react-app React application (like a dev version and production version) with two different custom domains? Through a little hack, this is pretty easy to set up.</p><h3>1. Create two repos</h3><p>You'll need two repos:</p><ol><li>Your master repo, this will contain only your production site</li><li>Your dev repo, this will contain your development branch as well as your dev site</li></ol><h3>2. Enable GitHub Pages on both repos</h3><p>Select the master branch as the branch to use on both repos. GitHub should pick up the domain from the CNAME files.</p><h3>3. Add two CNAMEs</h3><p>In your source, add a CNAME file to the public folder with your dev domain. For example:</p><p>public/CNAME</p><pre class="language-undefined line-numbers"><code class="language-undefined">officerhalf.dev<span aria-hidden="true" class="line-numbers-rows"><span></span></span></code></pre><p>Now add another CNAME file for your production environment. I've named this ProdCNAME:</p><p>public/ProdCNAME</p><pre class="language-undefined line-numbers"><code class="language-undefined">www.nathan-smith.org<span aria-hidden="true" class="line-numbers-rows"><span></span></span></code></pre><h3>4. Setup gh-pages and publishing</h3><p>In your CRA, install gh-pages:</p><pre class="language-undefined line-numbers"><code class="language-undefined">npm install --save-dev gh-pages<span aria-hidden="true" class="line-numbers-rows"><span></span></span></code></pre><p>Now, we need to enable publishing by adding new scripts and attributes to our package.json:</p><pre class="language-undefined line-numbers"><code class="language-undefined">"scripts": {
  "predeploy": "npm run build",
  "deploy": "gh-pages -d build -b master",
  "swap-cname": "rm ./build/CNAME && mv ./build/ProdCNAME ./build/CNAME",
  "preproduction": "npm run build && npm run swap-cname",
  "production": "gh-pages -d build -b master -r https://github.com/OfficerHalf/OfficerHalf.github.io.git"
}<span aria-hidden="true" class="line-numbers-rows"><span></span><span></span><span></span><span></span><span></span><span></span><span></span></span></code></pre><p>There are a few things happening here:</p><ol><li>The predeploy and deploy scripts are just copied from the <a href="https://create-react-app.dev/docs/deployment/#github-pages" rel="follow">create-react-app documentation</a>.</li><li>The swap-cname script removes CNAME and renames ProdCNAME to CNAME for the production deployment.</li><li>The production script pushes the code to a different repo.</li></ol><h3>5. Deploy to dev and prod</h3><p>All that's left is to deploy to each environment:</p><pre class="language-undefined line-numbers"><code class="language-undefined">// for dev
npm run deploy

// for prod
npm run production<span aria-hidden="true" class="line-numbers-rows"><span></span><span></span><span></span><span></span><span></span></span></code></pre><p></p><p>For a full example you can check the <a href="https://github.com/OfficerHalf/dev-site" rel="follow">repo for this site</a>.</p></div></div></div></div><script>!function(e){function t(t){for(var n,i,l=t[0],f=t[1],a=t[2],c=0,s=[];c<l.length;c++)i=l[c],Object.prototype.hasOwnProperty.call(o,i)&&o[i]&&s.push(o[i][0]),o[i]=0;for(n in f)Object.prototype.hasOwnProperty.call(f,n)&&(e[n]=f[n]);for(p&&p(t);s.length;)s.shift()();return u.push.apply(u,a||[]),r()}function r(){for(var e,t=0;t<u.length;t++){for(var r=u[t],n=!0,l=1;l<r.length;l++){var f=r[l];0!==o[f]&&(n=!1)}n&&(u.splice(t--,1),e=i(i.s=r[0]))}return e}var n={},o={1:0},u=[];function i(t){if(n[t])return n[t].exports;var r=n[t]={i:t,l:!1,exports:{}};return e[t].call(r.exports,r,r.exports,i),r.l=!0,r.exports}i.m=e,i.c=n,i.d=function(e,t,r){i.o(e,t)||Object.defineProperty(e,t,{enumerable:!0,get:r})},i.r=function(e){"undefined"!=typeof Symbol&&Symbol.toStringTag&&Object.defineProperty(e,Symbol.toStringTag,{value:"Module"}),Object.defineProperty(e,"__esModule",{value:!0})},i.t=function(e,t){if(1&t&&(e=i(e)),8&t)return e;if(4&t&&"object"==typeof e&&e&&e.__esModule)return e;var r=Object.create(null);if(i.r(r),Object.defineProperty(r,"default",{enumerable:!0,value:e}),2&t&&"string"!=typeof e)for(var n in e)i.d(r,n,function(t){return e[t]}.bind(null,n));return r},i.n=function(e){var t=e&&e.__esModule?function(){return e.default}:function(){return e};return i.d(t,"a",t),t},i.o=function(e,t){return Object.prototype.hasOwnProperty.call(e,t)},i.p="/";var l=this["webpackJsonpdev-site"]=this["webpackJsonpdev-site"]||[],f=l.push.bind(l);l.push=t,l=l.slice();for(var a=0;a<l.length;a++)t(l[a]);var p=f;r()}([])</script><script src="/static/js/2.e65eb1f7.chunk.js"></script><script src="/static/js/main.862cb4f0.chunk.js"></script></body></html>